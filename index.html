<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interface to ECMWF and CDS Data Web Services • ecmwfr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- Fonts --><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Titillium+Web:ital,wght@0,300;0,400;0,700;1,300;1,400&amp;display=swap" rel="stylesheet">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><!-- ropensci --><link href="bglabs.css" rel="stylesheet">
<meta property="og:title" content="Interface to ECMWF and CDS Data Web Services">
<meta property="og:description" content="Programmatic interface to the European Centre for Medium-Range Weather Forecasts dataset web services (ECMWF; &lt;https://www.ecmwf.int/&gt;) and Copernicus's Data Stores. Allows for easy downloads of weather forecasts and climate reanalysis data in R. Data stores covered include the Climate Data Store (CDS; &lt;https://cds.climate.copernicus.eu&gt;), Atmosphere Data Store (ADS; &lt;https://ads.atmosphere.copernicus.eu&gt;) and Early Warning Data Store (CEMS; &lt;https://ewds.climate.copernicus.eu&gt;).">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">

    <div class="navbar-header">

      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="external-link hidden-sm hidden-xs" href="https://bluegreenlabs.org">
          <img src="https://bluegreenlabs.org/img/logo_text_small.png" id="hexlogo" alt="bluegreen labs"></a>
        <a class="external-link hidden-md hidden-lg" href="https://bluegreenlabs.org">
          <img src="https://bluegreenlabs.org/img/logo.png" id="hexlogo" alt="bluegreen labs"></a>
        <a class="navbar-brand" href="index.html">
           <i>ecmwfr <small>v2.0.3</small></i>
        </a>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/advanced_vignette.html">Advanced Features</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/bluegreen-labs/ecmwfr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="ecmwfr-">ecmwfr <img src="reference/figures/logo.png" align="right" height="138.5"><a class="anchor" aria-label="anchor" href="#ecmwfr-"></a>
</h1></div>
<p><a href="https://github.com/bluegreen-labs/ecmwfr/actions" class="external-link"><img src="https://github.com/bluegreen-labs/ecmwfr/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a> <a href="https://app.codecov.io/gh/bluegreen-labs/ecmwfr" class="external-link"><img src="https://codecov.io/gh/bluegreen-labs/ecmwfr/branch/master/graph/badge.svg" alt="codecov"></a> <a href="https://cran.r-project.org/package=ecmwfr" class="external-link"><img src="https://www.r-pkg.org/badges/version/ecmwfr" alt="CRAN_Status_Badge"></a> <a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a> <a href="https://cran.r-project.org/package=ecmwfr" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/ecmwfr"></a> <a href="https://zenodo.org/badge/latestdoi/156325084" class="external-link"><img src="https://zenodo.org/badge/156325084.svg" alt="DOI"></a></p>
<p>Programmatic interface to the two <a href="https://www.ecmwf.int/" class="external-link">European Centre for Medium-Range Weather Forecasts</a> API services. The package provides easy access to all available Data Stores from within R, matching and expanding upon the ECMWF python tools. Support is provided for the <a href="https://cds.climate.copernicus.eu" class="external-link">Climate Data Store</a>, the <a href="https://ads.atmosphere.copernicus.eu" class="external-link">Atmosphere Data Store</a> and the <a href="https://ewds.climate.copernicus.eu" class="external-link">Early Warning Data Store</a> (from the Copernicus Emergency Management Services).</p>
<div class="section level2">
<h2 id="how-to-cite-this-package">How to cite this package<a class="anchor" aria-label="anchor" href="#how-to-cite-this-package"></a>
</h2>
<p>You can cite this package like this “we obtained data from the European Centre for Medium-Range Weather Forecasts API using the ecmwf R package (Hufkens, Stauffer, and Campitelli 2019)”. Here is the full bibliographic reference to include in your reference list (don’t forget to update the ‘last accessed’ date):</p>
<blockquote>
<p>Hufkens, K., R. Stauffer, &amp; E. Campitelli. (2019). ecmwfr: Programmatic interface to the two European Centre for Medium-Range Weather Forecasts API services. Zenodo. <a href="https://doi.org/10.5281/zenodo.2647531" class="external-link uri">https://doi.org/10.5281/zenodo.2647531</a>.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="stable-release">stable release<a class="anchor" aria-label="anchor" href="#stable-release"></a>
</h3>
<p>To install the current stable release use a CRAN repository:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ecmwfr"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/bluegreen-labs/ecmwfr" class="external-link">"ecmwfr"</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="development-release">development release<a class="anchor" aria-label="anchor" href="#development-release"></a>
</h3>
<p>To install the development releases of the package run the following commands:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"bluegreen-labs/ecmwfr"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/bluegreen-labs/ecmwfr" class="external-link">"ecmwfr"</a></span><span class="op">)</span></span></code></pre></div>
<p>Vignettes are not rendered by default, if you want to include additional documentation please use:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"bluegreen-labs/ecmwfr"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/bluegreen-labs/ecmwfr" class="external-link">"ecmwfr"</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="breaking-changes--200">breaking changes (&gt;= 2.0.0)<a class="anchor" aria-label="anchor" href="#breaking-changes--200"></a>
</h3>
<div class="section level4">
<h4 id="querying-data">querying data<a class="anchor" aria-label="anchor" href="#querying-data"></a>
</h4>
<p>With the introduction of version 2.0.0 and the migration to the new API some changes to the package were implemented which will cause breaking changes. In particular the <code><a href="reference/wf_request.html">wf_request()</a></code> function(s) now use a default <code>ecmwfr</code> user field due to the consolidation of the API, with a single sign-on across all services and the use of a Personal Access Token (PAT) rather than user and password credentials.</p>
<p>In order to migrate to version &gt;=2.0.0 you will have to provide a new PAT using <code><a href="reference/wf_set_key.html">wf_set_key()</a></code> and remove the user argument from any <code><a href="reference/wf_request.html">wf_request()</a></code> call, i.e.:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The original v1.x.x call</span></span>
<span><span class="fu"><a href="reference/wf_request.html">wf_request</a></span><span class="op">(</span></span>
<span>  <span class="va">request</span>,</span>
<span>  user <span class="op">=</span> <span class="st">"your_id"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The new v2.x.x call</span></span>
<span><span class="fu"><a href="reference/wf_request.html">wf_request</a></span><span class="op">(</span></span>
<span>  <span class="va">request</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The requests themselves should translate mostly without intervention and remain nested lists of parameters.</p>
</div>
<div class="section level4">
<h4 id="netcdf-data-format">netCDF data format<a class="anchor" aria-label="anchor" href="#netcdf-data-format"></a>
</h4>
<p>In comparison with the original services the new API <a href="https://forum.ecmwf.int/t/changes-to-grib-to-netcdf-converter-on-cds-beta-ads-beta/4322" class="external-link">regresses in terms of netCDF support</a>. Those relying on common netCDF support such as ecosystem modellers will find this troubling. Note that both CDS and ADS have different policies and use different methods. Note that this regression in usability is not caused by this package. Please forward any issues you have with formatting of the data to the ECMWF using <a href="https://forum.ecmwf.int/t/changes-to-grib-to-netcdf-converter-on-cds-beta-ads-beta/4322" class="external-link">the public forum</a>. We suggest to fall back to grib files, and convert internally if netCDF driver files are needed. Sadly, consistency for now is not, and will not be, guaranteed it seems.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="use-ecmwf-data-store-services">Use: ECMWF Data Store services<a class="anchor" aria-label="anchor" href="#use-ecmwf-data-store-services"></a>
</h2>
<p>Create a ECMWF account by <a href="https://accounts.ecmwf.int/auth/realms/ecmwf/protocol/openid-connect/auth?client_id=cms-www&amp;response_type=code&amp;scope=openid%20email%20profile&amp;redirect_uri=https%3A//www.ecmwf.int/openid-connect/" class="external-link">self registering</a>. Once your user account has been verified you can get your personal access token or <em>key</em> by visiting one of the Data Stores user profiles, for example the CDS <a href="https://cds.climate.copernicus.eu/profile" class="external-link">user profile</a>.</p>
<p>The Personal Access Token is a long string of letters and numbers:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="er">Personal</span> <span class="er">Access</span> <span class="er">Token:</span> <span class="er">abcd1234-foo-bar-98765431-XXXXXXXXXX</span></span></code></pre></div>
<p>This Personal Access Token gives you access to all Data Store services, including the climate atmosphere and emergency management services. This information is required to be able to retrieve data via the <code>ecmwfr</code> package. Use the <code>ecmwfr</code> <a href="references/wf_set_key.html"><code>wf_set_key</code></a> function to store your login information in the system keyring (see below).</p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>You have to save your login information before proceeding. The package does not allow you to use your key inline in scripts to limit security issues when sharing scripts on github or otherwise. <strong>The following lines should NEVER be included in any script and run only once at setup.</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set a key to the keychain</span></span>
<span><span class="fu"><a href="reference/wf_set_key.html">wf_set_key</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"abcd1234-foo-bar-98765431-XXXXXXXXXX"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># you can retrieve the key using</span></span>
<span><span class="fu"><a href="reference/wf_get_key.html">wf_get_key</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the output should be the key you provided</span></span>
<span><span class="co"># "abcd1234-foo-bar-98765431-XXXXXXXXXX"</span></span>
<span></span>
<span><span class="co"># Alternatively you can input your login info with an interactive request</span></span>
<span><span class="co"># if you do not put in the key directly</span></span>
<span><span class="fu"><a href="reference/wf_set_key.html">wf_set_key</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># you will get a command line request to provide the required details</span></span></code></pre></div>
<p>Before you can download any data you have to make sure to accept the terms and conditions here: Before downloading and processing data from CDS please make sure you accept the terms and conditions in the profile pages of your Data Store of choice.</p>
</div>
<div class="section level3">
<h3 id="data-requests">Data Requests<a class="anchor" aria-label="anchor" href="#data-requests"></a>
</h3>
<p>To download data use the <a href="references/wf_request.html"><code>wf_request</code></a> function, and a request string syntax. The simplest way to get the requests is to go to the Data Store website which offers an interactive interface to create these requests e.g., for the CDS ERA-5 reanalysis data:</p>
<ul>
<li><a href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-pressure-levels?tab=download" class="external-link">ERA-5 at pressure level data</a></li>
<li><a href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-land?tab=download" class="external-link">ERA-5 land</a></li>
<li>…</li>
</ul>
<p>After formatting the request online copy the API request python code to your script. The request should include the <em>dataset</em>, <em>request</em> and <em>target</em> field (if available).</p>
<p><img src="https://github.com/user-attachments/assets/865fcf2a-e4da-4fd8-80a8-9ced448caabb"></p>
<p>Instead of <code>json</code> formatting as shown in the online form the <code>ecmwfr</code> package uses a <em>R</em> lists for all the arguments. This makes changing variables less prone to error, although overall we suggest not to manually create requests and use the RStudio Addin to translate the python <code>json</code> request to <em>R</em> as shown below.</p>
<p>Just select the whole query, including the dataset and target fields, and click on the Addins &gt; ECMWF Python to list. The original python query is listed below so you can try this routine yourself.</p>
<p><img src="https://github.com/user-attachments/assets/100cf392-3214-4bcd-b308-7ef7a50308a0"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># The full python query, which you can translate to an R</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># list using the Addin</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>dataset <span class="op">=</span> <span class="st">"reanalysis-era5-pressure-levels"</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>request <span class="op">=</span> {</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="st">'product_type'</span>: [<span class="st">'reanalysis'</span>],</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="st">'variable'</span>: [<span class="st">'temperature'</span>],</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="st">'year'</span>: [<span class="st">'2000'</span>],</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="st">'month'</span>: [<span class="st">'04'</span>],</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="st">'day'</span>: [<span class="st">'04'</span>],</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  <span class="st">'time'</span>: [<span class="st">'00:00'</span>],</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>  <span class="st">'pressure_level'</span>: [<span class="st">'850'</span>],</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>  <span class="st">'data_format'</span>: <span class="st">'netcdf'</span>,</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>  <span class="st">'download_format'</span>: <span class="st">'unarchived'</span>,</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>  <span class="st">'area'</span>: [<span class="dv">70</span>, <span class="op">-</span><span class="dv">20</span>, <span class="dv">60</span>, <span class="dv">30</span>]</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>}</span></code></pre></div>
<p>This will give you a request as an annotated list. If no target file is specified in the original request a <em>target</em> field will be added to the list with a default name <code>TMPFILE</code>. Replace this filename with something that matches your preference and the specified data format. In this case the default name was changed to <code>era5-demo.nc</code>, a netcdf file. This formatted request can now be used by the <a href="references/wf_request.html"><code>wf_request</code></a> function to query and download the data. By default the process is verbose, and will give you plenty of feedback on progress.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This is an example of a request as converted from </span></span>
<span><span class="va">request</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  dataset_short_name <span class="op">=</span> <span class="st">"reanalysis-era5-pressure-levels"</span>,</span>
<span>  product_type <span class="op">=</span> <span class="st">"reanalysis"</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"temperature"</span>,</span>
<span>  year <span class="op">=</span> <span class="st">"2000"</span>,</span>
<span>  month <span class="op">=</span> <span class="st">"04"</span>,</span>
<span>  day <span class="op">=</span> <span class="st">"04"</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"00:00"</span>,</span>
<span>  pressure_level <span class="op">=</span> <span class="st">"850"</span>,</span>
<span>  data_format <span class="op">=</span> <span class="st">"netcdf"</span>,</span>
<span>  download_format <span class="op">=</span> <span class="st">"unarchived"</span>,</span>
<span>  area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>, <span class="op">-</span><span class="fl">20</span>, <span class="fl">60</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  target <span class="op">=</span> <span class="st">"era5-demo.nc"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If you have stored your user login information</span></span>
<span><span class="co"># in the keyring by calling cds_set_key you can</span></span>
<span><span class="co"># call:</span></span>
<span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/wf_request.html">wf_request</a></span><span class="op">(</span></span>
<span> request  <span class="op">=</span> <span class="va">request</span>,  <span class="co"># the request</span></span>
<span> transfer <span class="op">=</span> <span class="cn">TRUE</span>,     <span class="co"># download the file</span></span>
<span> path     <span class="op">=</span> <span class="st">"."</span>       <span class="co"># store data in current working directory</span></span>
<span> <span class="op">)</span></span></code></pre></div>
<p>The Data Store services are quite fast, however, if you request a lot of variables, multiple levels, and data over several years these requests might take quite a while! You can check the scope of your query and if it is out of bounds in the right hand <code>Request Validation</code> panel when formatting your original data request in the web interface.</p>
<p><strong>Note</strong>: If you need to download larger amounts of data it is suggested to split the downloads, e.g., download the data in chunks (e.g., month-by-month, or year-by-year). A progress indicator will keep you informed on the status of your request. Keep in mind that all data downloaded will be buffered in memory limiting the downloads to ~6GB on low end systems.</p>
<div class="section level4">
<h4 id="era5-demo">ERA5 demo<a class="anchor" aria-label="anchor" href="#era5-demo"></a>
</h4>
<p>The above request uses ERA-5 reanalysis data on pressure levels.</p>
<ul>
<li>
<code>dataset</code>: downloading ERA-5 reanalysis on pressure level(s)</li>
<li>
<code>product_type</code>: (deterministic) reanalysis data</li>
<li>
<code>variable</code>/<code>pressure_level</code>: requesting temperature on 850 hectopascal</li>
<li>
<code>year</code>/<code>month</code>/<code>day</code>: April 4, 2000 (one day in this example)</li>
<li>
<code>time</code>: valid at 00:00 UTC (date/time always in UTC),</li>
<li>
<code>area</code>: custom subset covering northern Europe</li>
<li>
<code>format</code>: output format NetCDF</li>
<li>
<code>target</code>: local output file <code>era5-demo.nc</code>
</li>
</ul>
<p>The data set as specified above can be downloaded calling the <code>wf_request</code> function, and upon request returns the location of the NetCDF file on your system. The <code>file</code> variable can then be used directly for further processing (note: should the download be interupted the job ID in your download queue is returned and the job can be resumed using <code><a href="reference/wf_transfer.html">wf_transfer()</a></code>).</p>
<p>Once the retrieval has finished you should now be the owner of a NetCDF containing the requested information located in the current working directory, called <code>era5-demo.nc</code>.</p>
<p>We can quickly visualize this data using the <code>terra</code> geospatial library using:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Open NetCDF file and plot the data</span></span>
<span><span class="co"># (trap read error on mac - if gdal netcdf support is missing)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span>, main <span class="op">=</span> <span class="st">"ERA-5 Reanalysis Demo (2m Temperature 850 hPa)"</span><span class="op">)</span></span>
<span><span class="fu">maps</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html" class="external-link">map</a></span><span class="op">(</span><span class="st">"world"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/user-attachments/assets/27a89664-7aaf-483f-94dd-8d9992e862be" alt="spatial-plot"><div class="figcaption">spatial-plot</div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="file-and-system-based-keychains">File and system based keychains<a class="anchor" aria-label="anchor" href="#file-and-system-based-keychains"></a>
</h2>
<p>On linux you can opt to use a file based keyring, instead of a GUI based keyring manager. This is helpful for headless setups such as servers. For this option to work linux users must set an environmental option.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>keyring_backend<span class="op">=</span><span class="st">"file"</span><span class="op">)</span></span></code></pre></div>
<p>You will be asked to provide a password to encrypt the keyring with. Upon the start of each session you will be asked to provide this password, unlocking all <code>ecmwfr</code> credentials for this session. Should you ever forget the password just delete the file at: <code>~/.config/r-keyring/ecmwfr.keyring</code> and re-enter all your credentials.</p>
</div>
<div class="section level2">
<h2 id="date-specification">Date specification<a class="anchor" aria-label="anchor" href="#date-specification"></a>
</h2>
<p>For those familiar with the old ECMWF <em>mars</em> syntax: CDS/ADS/CEMS does not accept <code>date = "2000-01-01/to/2000-12-31"</code> specifications. It is possible to specify one specific date via <code>date = "2000-01-01"</code> or multiple days via <code>date = ["2000-01-01","2000-01-02","2000-10-20"]</code> or <code>date = "YYYY-MM-DD/YYYY-MM-DD"</code>.</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Hufkens, K., R. Stauffer, &amp; E. Campitelli. (2019). ecmwfr: Programmatic interface to the two European Centre for Medium-Range Weather Forecasts API services. Zenodo. <a href="https://doi.org/10.5281/zenodo.2647531" class="external-link uri">https://doi.org/10.5281/zenodo.2647531</a>.</p>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>This project is maintained by BlueGreen Labs (BV). This project was in the past partially supported by the Belgian Science Policy office COBECORE project (BELSPO; grant BR/175/A3/COBECORE), a “Fonds voor Wetenschappelijk Onderzoek” travel grant (FWO; V438318N) and the Marie Skłodowska-Curie Action (H2020 grant 797668). Logo design elements are taken from the FontAwesome library according to <a href="https://fontawesome.com/license" class="external-link">these terms</a>, where the globe element was inverted and intersected.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ecmwfr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/bluegreen-labs/ecmwfr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/bluegreen-labs/ecmwfr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/AGPL-3" class="external-link">AGPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ecmwfr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://bluegreenlabs.org" class="external-link">Koen Hufkens</a> <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-5070-8109" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>
<a href="https://bluegreenlabs.org" class="external-link">BlueGreen Labs</a> <br><small class="roles"> Funder </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start bottom-8">
            <div class="col-xs-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="http://github.com/bluegreen-labs" target="_blank" class="external-link">
                          <div class="icon fab fa-github"></div></a>
                        <a href="https://bluegreenlabs.org/labs/" target="_blank" class="external-link">
                          <div class="icon fa fa-flask"></div></a>
                        <a href="http://twitter.com/bluegreen_labs" target="_blank" class="external-link">
                          <div class="icon fab fa-twitter"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://bluegreenlabs.org/#intro" class="external-link">BlueGreen Labs</a></li>
                            <li><a href="https://bluegreenlabs.org/#people" class="external-link">Our Team</a></li>
                            <li><a href="https://bluegreenlabs.org/#contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://github.com/bluegreen-labs" class="external-link">Packages</a></li>
                            <li><a href="https://bluegreenlabs.org/publication/" class="external-link">Publications</a></li>
                            <li><a href="https://bluegreenlabs.org/post/" class="external-link">Blog</a></li>
                        </ul>
</div>

                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->

      </footer>
</div>






  </body>
</html>
